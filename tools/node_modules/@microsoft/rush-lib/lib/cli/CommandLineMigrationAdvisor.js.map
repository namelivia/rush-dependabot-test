{"version":3,"file":"CommandLineMigrationAdvisor.js","sourceRoot":"","sources":["../../src/cli/CommandLineMigrationAdvisor.ts"],"names":[],"mappings":";AAAA,4FAA4F;AAC5F,2DAA2D;;;;;;AAE3D,uDAAiC;AACjC,kDAAqD;AAErD,0DAAuD;AAEvD,MAAa,2BAA2B;IACtC,wDAAwD;IACxD,mFAAmF;IAC5E,MAAM,CAAC,SAAS,CAAC,IAAc;QACpC,4BAA4B;QAC5B,MAAM,IAAI,GAAa,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAE7C,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;YACnB,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;gBAC1B,2BAA2B,CAAC,iBAAiB,CAC3C,wEAAwE,CACzE,CAAC;gBACF,OAAO,KAAK,CAAC;aACd;YAED,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;gBACzB,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;oBACrC,2BAA2B,CAAC,iBAAiB,CAC3C,oEAAoE,CACrE,CAAC;oBACF,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;oBAC3B,2BAA2B,CAAC,iBAAiB,CAC3C,0DAA0D,CAC3D,CAAC;oBACF,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE;oBAChC,2BAA2B,CAAC,iBAAiB,CAC3C,gEAAgE,CACjE,CAAC;oBACF,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;oBAC3B,2BAA2B,CAAC,iBAAiB,CAC3C,2DAA2D,CAC5D,CAAC;oBACF,OAAO,KAAK,CAAC;iBACd;aACF;SACF;QAED,qBAAqB;QACrB,OAAO,IAAI,CAAC;IACd,CAAC;IAEO,MAAM,CAAC,iBAAiB,CAAC,OAAe;QAC9C,OAAO,CAAC,KAAK,CACX,cAAM,CAAC,GAAG,CACR,yBAAc,CAAC,SAAS,CACtB,oGAAoG,CACrG,CACF,CACF,CAAC;QACF,OAAO,CAAC,KAAK,CAAC,cAAM,CAAC,MAAM,CAAC,yBAAc,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAChE,OAAO,CAAC,KAAK,EAAE,CAAC;QAChB,OAAO,CAAC,KAAK,CACX,yBAAc,CAAC,SAAS,CACtB,qEAAqE;YACnE,iBAAiB,6BAAa,CAAC,cAAc,EAAE,CAClD,CACF,CAAC;IACJ,CAAC;CACF;AAhED,kEAgEC","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n// See LICENSE in the project root for license information.\n\nimport colors from 'colors/safe';\nimport { PrintUtilities } from '@rushstack/terminal';\n\nimport { RushConstants } from '../logic/RushConstants';\n\nexport class CommandLineMigrationAdvisor {\n  // NOTE: THIS RUNS BEFORE THE REAL COMMAND-LINE PARSING.\n  // TAKE EXTREME CARE THAT THE HEURISTICS CANNOT FALSELY MATCH A VALID COMMAND LINE.\n  public static checkArgv(argv: string[]): boolean {\n    // 0=node.exe, 1=script name\n    const args: string[] = process.argv.slice(2);\n\n    if (args.length > 0) {\n      if (args[0] === 'generate') {\n        CommandLineMigrationAdvisor._reportDeprecated(\n          'Instead of \"rush generate\", use \"rush update\" or \"rush update --full\".'\n        );\n        return false;\n      }\n\n      if (args[0] === 'install') {\n        if (args.indexOf('--full-clean') >= 0) {\n          CommandLineMigrationAdvisor._reportDeprecated(\n            'Instead of \"rush install --full-clean\", use \"rush purge --unsafe\".'\n          );\n          return false;\n        }\n        if (args.indexOf('-C') >= 0) {\n          CommandLineMigrationAdvisor._reportDeprecated(\n            'Instead of \"rush install -C\", use \"rush purge --unsafe\".'\n          );\n          return false;\n        }\n        if (args.indexOf('--clean') >= 0) {\n          CommandLineMigrationAdvisor._reportDeprecated(\n            'Instead of \"rush install --clean\", use \"rush install --purge\".'\n          );\n          return false;\n        }\n        if (args.indexOf('-c') >= 0) {\n          CommandLineMigrationAdvisor._reportDeprecated(\n            'Instead of \"rush install -c\", use \"rush install --purge\".'\n          );\n          return false;\n        }\n      }\n    }\n\n    // Everything is okay\n    return true;\n  }\n\n  private static _reportDeprecated(message: string): void {\n    console.error(\n      colors.red(\n        PrintUtilities.wrapWords(\n          'ERROR: You specified an outdated command-line that is no longer supported by this version of Rush:'\n        )\n      )\n    );\n    console.error(colors.yellow(PrintUtilities.wrapWords(message)));\n    console.error();\n    console.error(\n      PrintUtilities.wrapWords(\n        `For command-line help, type \"rush -h\".  For migration instructions,` +\n          ` please visit ${RushConstants.rushWebSiteUrl}`\n      )\n    );\n  }\n}\n"]}