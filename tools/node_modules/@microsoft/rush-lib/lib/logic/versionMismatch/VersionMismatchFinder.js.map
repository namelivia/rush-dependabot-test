{"version":3,"file":"VersionMismatchFinder.js","sourceRoot":"","sources":["../../../src/logic/versionMismatch/VersionMismatchFinder.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n// See LICENSE in the project root for license information.\n\nimport colors from 'colors/safe';\nimport { AlreadyReportedError } from '@rushstack/node-core-library';\n\nimport { RushConfiguration } from '../../api/RushConfiguration';\nimport { PackageJsonDependency, DependencyType } from '../../api/PackageJsonEditor';\nimport { CommonVersionsConfiguration } from '../../api/CommonVersionsConfiguration';\nimport { VersionMismatchFinderEntity } from './VersionMismatchFinderEntity';\nimport { VersionMismatchFinderProject } from './VersionMismatchFinderProject';\nimport { VersionMismatchFinderCommonVersions } from './VersionMismatchFinderCommonVersions';\n\nconst TRUNCATE_AFTER_PACKAGE_NAME_COUNT: number = 5;\n\nexport interface IVersionMismatchFinderOptions {\n  variant?: string | undefined;\n}\n\nexport interface IVersionMismatchFinderRushCheckOptions extends IVersionMismatchFinderOptions {\n  printAsJson?: boolean | undefined;\n  truncateLongPackageNameLists?: boolean | undefined;\n}\n\nexport interface IVersionMismatchFinderEnsureConsistentVersionsOptions\n  extends IVersionMismatchFinderOptions {}\n\nexport interface IVersionMismatchFinderGetMismatchesOptions extends IVersionMismatchFinderOptions {}\n\nexport interface IMismatchDependency {\n  dependencyName: string;\n  versions: IMismatchDependencyVersion[];\n}\n\nexport interface IMismatchDependencyVersion {\n  version: string;\n  projects: string[];\n}\n\nexport interface IMismatchDependencies {\n  mismatchedVersions: IMismatchDependency[];\n}\n\nexport class VersionMismatchFinder {\n  /* store it like this:\n   * {\n   *   \"@types/node\": {\n   *     \"1.0.0\": [ '@ms/rush' ]\n   *   }\n   * }\n   */\n  private _allowedAlternativeVersion: Map<string, ReadonlyArray<string>>;\n  private _mismatches: Map<string, Map<string, VersionMismatchFinderEntity[]>>;\n  private _projects: VersionMismatchFinderEntity[];\n\n  public constructor(\n    projects: VersionMismatchFinderEntity[],\n    allowedAlternativeVersions?: Map<string, ReadonlyArray<string>>\n  ) {\n    this._projects = projects;\n    this._mismatches = new Map<string, Map<string, VersionMismatchFinderEntity[]>>();\n    this._allowedAlternativeVersion = allowedAlternativeVersions || new Map<string, ReadonlyArray<string>>();\n    this._analyze();\n  }\n\n  public static rushCheck(\n    rushConfiguration: RushConfiguration,\n    options: IVersionMismatchFinderRushCheckOptions = {}\n  ): void {\n    VersionMismatchFinder._checkForInconsistentVersions(rushConfiguration, {\n      ...options,\n      isRushCheckCommand: true\n    });\n  }\n\n  public static ensureConsistentVersions(\n    rushConfiguration: RushConfiguration,\n    options: IVersionMismatchFinderEnsureConsistentVersionsOptions = {}\n  ): void {\n    VersionMismatchFinder._checkForInconsistentVersions(rushConfiguration, {\n      ...options,\n      isRushCheckCommand: false,\n      truncateLongPackageNameLists: true\n    });\n  }\n\n  /**\n   * Populates a version mismatch finder object given a Rush Configuration.\n   * Intentionally considers preferred versions.\n   */\n  public static getMismatches(\n    rushConfiguration: RushConfiguration,\n    options: IVersionMismatchFinderOptions = {}\n  ): VersionMismatchFinder {\n    const commonVersions: CommonVersionsConfiguration = rushConfiguration.getCommonVersions(options.variant);\n\n    const projects: VersionMismatchFinderEntity[] = [];\n\n    // Create an object for the purposes of reporting conflicts with preferredVersions from common-versions.json\n    // Make sure this one is first so it doesn't get truncated when a long list is printed\n    projects.push(new VersionMismatchFinderCommonVersions(commonVersions));\n\n    for (const project of rushConfiguration.projects) {\n      projects.push(new VersionMismatchFinderProject(project));\n    }\n\n    return new VersionMismatchFinder(projects, commonVersions.allowedAlternativeVersions);\n  }\n\n  private static _checkForInconsistentVersions(\n    rushConfiguration: RushConfiguration,\n    options: {\n      isRushCheckCommand: boolean;\n      variant?: string | undefined;\n      printAsJson?: boolean | undefined;\n      truncateLongPackageNameLists?: boolean | undefined;\n    }\n  ): void {\n    if (rushConfiguration.ensureConsistentVersions || options.isRushCheckCommand) {\n      const mismatchFinder: VersionMismatchFinder = VersionMismatchFinder.getMismatches(\n        rushConfiguration,\n        options\n      );\n\n      if (options.printAsJson) {\n        mismatchFinder.printAsJson();\n      } else {\n        mismatchFinder.print(options.truncateLongPackageNameLists);\n\n        if (mismatchFinder.numberOfMismatches > 0) {\n          console.log(colors.red(`Found ${mismatchFinder.numberOfMismatches} mis-matching dependencies!`));\n          if (!options.isRushCheckCommand && options.truncateLongPackageNameLists) {\n            // There isn't a --verbose flag in `rush install`/`rush update`, so a long list will always be truncated.\n            console.log(\n              'For more detailed reporting about these version mismatches, use the \"rush check --verbose\" command.'\n            );\n          }\n\n          throw new AlreadyReportedError();\n        } else {\n          if (options.isRushCheckCommand) {\n            console.log(colors.green(`Found no mis-matching dependencies!`));\n          }\n        }\n      }\n    }\n  }\n\n  public get numberOfMismatches(): number {\n    return this._mismatches.size;\n  }\n\n  public getMismatches(): string[] {\n    return this._getKeys(this._mismatches);\n  }\n\n  public getVersionsOfMismatch(mismatch: string): string[] | undefined {\n    return this._mismatches.has(mismatch) ? this._getKeys(this._mismatches.get(mismatch)) : undefined;\n  }\n\n  public getConsumersOfMismatch(\n    mismatch: string,\n    version: string\n  ): VersionMismatchFinderEntity[] | undefined {\n    const mismatchedPackage: Map<string, VersionMismatchFinderEntity[]> | undefined =\n      this._mismatches.get(mismatch);\n    if (!mismatchedPackage) {\n      return undefined;\n    }\n\n    const mismatchedVersion: VersionMismatchFinderEntity[] | undefined = mismatchedPackage.get(version);\n    return mismatchedVersion;\n  }\n\n  public printAsJson(): void {\n    const mismatchDependencies: IMismatchDependency[] = [];\n\n    this.getMismatches().forEach((dependency: string) => {\n      const mismatchDependencyVersionArray: IMismatchDependencyVersion[] = [];\n      this.getVersionsOfMismatch(dependency)!.forEach((version: string) => {\n        const projects: string[] = [];\n        this.getConsumersOfMismatch(dependency, version)!.forEach((project: VersionMismatchFinderEntity) => {\n          projects.push(project.friendlyName);\n        });\n        const mismatchDependencyVersion: IMismatchDependencyVersion = {\n          version: version,\n          projects: projects\n        };\n        mismatchDependencyVersionArray.push(mismatchDependencyVersion);\n      });\n      const mismatchDependency: IMismatchDependency = {\n        dependencyName: dependency,\n        versions: mismatchDependencyVersionArray\n      };\n      mismatchDependencies.push(mismatchDependency);\n    });\n\n    const output: IMismatchDependencies = {\n      mismatchedVersions: mismatchDependencies\n    };\n\n    console.log(JSON.stringify(output, undefined, 2));\n  }\n\n  public print(truncateLongPackageNameLists: boolean = false): void {\n    // Iterate over the list. For any dependency with mismatching versions, print the projects\n    this.getMismatches().forEach((dependency: string) => {\n      console.log(colors.yellow(dependency));\n      this.getVersionsOfMismatch(dependency)!.forEach((version: string) => {\n        console.log(`  ${version}`);\n        const consumersOfMismatch: VersionMismatchFinderEntity[] = this.getConsumersOfMismatch(\n          dependency,\n          version\n        )!;\n\n        let numberToPrint: number = truncateLongPackageNameLists\n          ? TRUNCATE_AFTER_PACKAGE_NAME_COUNT\n          : consumersOfMismatch.length;\n        let numberRemaining: number = consumersOfMismatch.length;\n        for (const { friendlyName } of consumersOfMismatch) {\n          if (numberToPrint-- === 0) {\n            break;\n          }\n\n          numberRemaining--;\n\n          console.log(`   - ${friendlyName}`);\n        }\n\n        if (numberRemaining > 0) {\n          console.log(`   (and ${numberRemaining} others)`);\n        }\n      });\n      console.log();\n    });\n  }\n\n  private _analyze(): void {\n    this._projects.forEach((project: VersionMismatchFinderEntity) => {\n      if (!project.skipRushCheck) {\n        // NOTE: We do not consider peer dependencies here.  The purpose of \"rush check\" is\n        // mainly to avoid side-by-side duplicates in the node_modules folder, whereas\n        // peer dependencies are just a compatibility statement that will be satisfied by a\n        // regular dependency.  (It might be useful for Rush to help people keep their peer dependency\n        // patterns consistent, but on the other hand different projects may have different\n        // levels of compatibility -- we should wait for someone to actually request this feature\n        // before we get into that.)\n        project.allDependencies.forEach((dependency: PackageJsonDependency) => {\n          if (dependency.dependencyType !== DependencyType.Peer) {\n            const version: string = dependency.version!;\n\n            const isCyclic: boolean = project.cyclicDependencyProjects.has(dependency.name);\n\n            if (this._isVersionAllowedAlternative(dependency.name, version)) {\n              return;\n            }\n\n            const name: string = dependency.name + (isCyclic ? ' (cyclic)' : '');\n\n            if (!this._mismatches.has(name)) {\n              this._mismatches.set(name, new Map<string, VersionMismatchFinderEntity[]>());\n            }\n\n            const dependencyVersions: Map<string, VersionMismatchFinderEntity[]> =\n              this._mismatches.get(name)!;\n\n            if (!dependencyVersions.has(version)) {\n              dependencyVersions.set(version, []);\n            }\n\n            dependencyVersions.get(version)!.push(project);\n          }\n        });\n      }\n    });\n\n    this._mismatches.forEach((mismatches: Map<string, VersionMismatchFinderEntity[]>, project: string) => {\n      if (mismatches.size <= 1) {\n        this._mismatches.delete(project);\n      }\n    });\n  }\n\n  private _isVersionAllowedAlternative(dependency: string, version: string): boolean {\n    const allowedAlternatives: ReadonlyArray<string> | undefined =\n      this._allowedAlternativeVersion.get(dependency);\n    return Boolean(allowedAlternatives && allowedAlternatives.indexOf(version) > -1);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _getKeys(iterable: Map<string, any> | undefined): string[] {\n    const keys: string[] = [];\n    if (iterable) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      iterable.forEach((value: any, key: string) => {\n        keys.push(key);\n      });\n    }\n    return keys;\n  }\n}\n"]}